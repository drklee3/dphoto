import Router from "./router";
import fetchMock from "jest-fetch-mock";
import {DirectoryListing, DirectoryItem, DirectoryItemType} from "./types";

describe("router", () => {
    beforeEach(() => {
        fetchMock.resetMocks()
    })

    it("gets request", async () => {
        fetchMock.mockResponseOnce(JSON.stringify({"current":"/dphoto/photos","files":[{"type":"File","name":"DSC_1424.jpg","exif":{"ApertureValue":"1.695994 EV","Artist":"\"Derrick Lee\"","BodySerialNumber":"\"3024706\"","CFAPattern":"0x0200020000010102","ColorSpace":"sRGB","Compression":"JPEG","Contrast":"normal","Copyright":"\"Derrick Lee <derrick@dlee.dev>\"","CustomRendered":"custom process","DateTime":"2020-01-25 12:48:41","DateTimeDigitized":"2020-01-16 17:48:57","DateTimeOriginal":"2020-01-16 17:48:57","ExifVersion":"2.3","ExposureBiasValue":"0 EV","ExposureMode":"auto exposure","ExposureProgram":"aperture priority","ExposureTime":"1/400 s","FNumber":"f/1.8","FileSource":"digital still camera","Flash":"not fired, no return light detection function, auto mode 0 (unknown)","FocalLength":"85 mm","FocalLengthIn35mmFilm":"85 mm","FocalPlaneResolutionUnit":"cm","FocalPlaneXResolution":"1683.0665283203125 pixels per cm","FocalPlaneYResolution":"1683.0665283203125 pixels per cm","GainControl":"none","JPEGInterchangeFormat":"1024","JPEGInterchangeFormatLength":"11152","LensModel":"\"85.0 mm f/1.8\"","LensSpecification":"85-85 mm, f/1.8-1.8","LightSource":"unknown","Make":"\"NIKON CORPORATION\"","MeteringMode":"pattern","Model":"\"NIKON Z 6\"","PhotographicSensitivity":"500","RecommendedExposureIndex":"500","ResolutionUnit":"inch","Saturation":"normal","SceneCaptureType":"standard","SceneType":"directly photographed image","SensingMethod":"one-chip color area sensor","SensitivityType":"REI","Sharpness":"normal","ShutterSpeedValue":"8.643856 EV","Software":"\"Adobe Photoshop Lightroom Classic 8.1 (Windows)\"","SubSecTimeDigitized":"\"85\"","SubSecTimeOriginal":"\"85\"","SubjectDistanceRange":"unknown","WhiteBalance":"auto white balance","XResolution":"72 pixels per inch","YResolution":"72 pixels per inch"}},{"type":"File","name":"DSC_2634.jpg","exif":{"ApertureValue":"1.695994 EV","Artist":"\"Derrick Lee\"","BodySerialNumber":"\"3024706\"","CFAPattern":"0x0200020000010102","ColorSpace":"sRGB","Compression":"JPEG","Contrast":"normal","Copyright":"\"Derrick Lee <derrick@dlee.dev>\"","CustomRendered":"custom process","DateTime":"2020-01-25 22:34:34","DateTimeDigitized":"2020-01-22 14:39:23","DateTimeOriginal":"2020-01-22 14:39:23","ExifVersion":"2.3","ExposureBiasValue":"0 EV","ExposureMode":"auto exposure","ExposureProgram":"aperture priority","ExposureTime":"1/200 s","FNumber":"f/1.8","FileSource":"digital still camera","Flash":"not fired, no return light detection function, auto mode 0 (unknown)","FocalLength":"50 mm","FocalLengthIn35mmFilm":"50 mm","FocalPlaneResolutionUnit":"cm","FocalPlaneXResolution":"1683.0665283203125 pixels per cm","FocalPlaneYResolution":"1683.0665283203125 pixels per cm","GainControl":"none","JPEGInterchangeFormat":"1024","JPEGInterchangeFormatLength":"22836","LensModel":"\"50.0 mm f/1.8\"","LensSpecification":"50-50 mm, f/1.8-1.8","LightSource":"unknown","Make":"\"NIKON CORPORATION\"","MeteringMode":"pattern","Model":"\"NIKON Z 6\"","PhotographicSensitivity":"560","RecommendedExposureIndex":"560","ResolutionUnit":"inch","Saturation":"normal","SceneCaptureType":"standard","SceneType":"directly photographed image","SensingMethod":"one-chip color area sensor","SensitivityType":"REI","Sharpness":"normal","ShutterSpeedValue":"7.643856 EV","Software":"\"Adobe Photoshop Lightroom Classic 8.1 (Windows)\"","SubSecTimeDigitized":"\"67\"","SubSecTimeOriginal":"\"67\"","SubjectDistanceRange":"unknown","WhiteBalance":"auto white balance","XResolution":"72 pixels per inch","YResolution":"72 pixels per inch"}},{"type":"File","name":"DSC_8783.jpg","exif":{"ApertureValue":"0.970854 EV","Artist":"\"Derrick Lee\"","BodySerialNumber":"\"3024706\"","CFAPattern":"0x0200020000010102","ColorSpace":"sRGB","Compression":"JPEG","Contrast":"normal","Copyright":"\"Derrick Lee <derrick@dlee.dev>\"","CustomRendered":"custom process","DateTime":"2020-01-06 18:00:20","DateTimeDigitized":"2020-01-06 14:44:47","DateTimeOriginal":"2020-01-06 14:44:47","ExifVersion":"2.3","ExposureBiasValue":"0 EV","ExposureMode":"auto exposure","ExposureProgram":"aperture priority","ExposureTime":"1/160 s","FNumber":"f/1.4","FileSource":"digital still camera","Flash":"not fired, no return light detection function, auto mode 0 (unknown)","FocalLength":"35 mm","FocalLengthIn35mmFilm":"35 mm","FocalPlaneResolutionUnit":"cm","FocalPlaneXResolution":"1683.0665283203125 pixels per cm","FocalPlaneYResolution":"1683.0665283203125 pixels per cm","GainControl":"none","JPEGInterchangeFormat":"1024","JPEGInterchangeFormatLength":"13350","LensModel":"\"35.0 mm f/1.4\"","LensSpecification":"35-35 mm, f/1.4-1.4","LightSource":"unknown","Make":"\"NIKON CORPORATION\"","MeteringMode":"pattern","Model":"\"NIKON Z 6\"","PhotographicSensitivity":"800","RecommendedExposureIndex":"800","ResolutionUnit":"inch","Saturation":"normal","SceneCaptureType":"standard","SceneType":"directly photographed image","SensingMethod":"one-chip color area sensor","SensitivityType":"REI","Sharpness":"normal","ShutterSpeedValue":"7.321928 EV","Software":"\"Adobe Photoshop Lightroom Classic 8.1 (Windows)\"","SubSecTimeDigitized":"\"40\"","SubSecTimeOriginal":"\"40\"","SubjectDistanceRange":"unknown","WhiteBalance":"auto white balance","XResolution":"72 pixels per inch","YResolution":"72 pixels per inch"}}]}));
        const router = new Router();
        await router.init();
        expect(router.albumData.files.length).toBe(3);
    })
})
